UBL Larsen
-----------
UBL Larsen is a library for streaming "UBL 2.0 updated" compliant xml files by using 
System.Xml.XmlSerializer. Knowledge of XmlSerialiser is preferred in order to 
understand how class instances can be converted to/from xml without any fiddly parsing.
http://msdn.microsoft.com/en-us/library/system.xml.serialization.xmlserializer.aspx

A similar library like UBL Larsen can be generated by using Microsoft tool "xsd.exe" and 
xsd files from http://docs.oasis-open.org/ubl/. However, everything gets piled up in one 
sourcefile and documentation comments from the xsd files are lost.

Requirements: Visual Studio 2010, C# .NET4.0, Platform SDK
Other versions do require some modifications. .NET 2.0 lack LINQ and object intializers :-( 
http://weblogs.asp.net/dwahlin/archive/2007/09/09/c-3-0-features-object-initializers.aspx

UBL Version: 2.0 updated


Compiling the library
----------------------
Project UblLarsen.Ubl contains all the sourcefiles required to compile the library. 
The following files are generated in bin\Debug or bin\Release when you compile.

UblLarsen.Ubl2.dll                The library
UblLarsen.Ubl2.XML                Documentation file for Visual Studio popup intellisence.
UblLarsen.Ubl2.XmlSerializers.dll Precompiled version of the library. (gives you the speed)

The post build event generates the precompiled version of the library by using sgen.exe 
which is part of the Platform SDK. If sgen.exe is not found just put "rem" in front 
of the postbuild command to suppress the error. The library should work without it, 
but will be slower the first time a UBL Larsen type is serialized. 


Unit test
----------
Most of the unit tests deserialize xml documents made by Oasis to an UBL Larsen class instance. 
This instance is then serialized back to xml and compared with the original using XmlDiffPatch.
http://msdn.microsoft.com/en-us/library/aa302294.aspx
Simple but effective method. 
Adding you own test for other documents types is simple. Have a look at UblDocLoadTest.cs.

"xs:time" is always local, not utc. (compliant to standard you may argue!). 


Using the library
------------------
In your project "Add Reference..." to UblLarsen.Ubl2.dll. Browse to the location where it got built.
in your source file add "using UblLarsen.Ubl2;".
Add references to the other namespaces as required. VS2010 IDE will make helpful suggestions.

The file UblDoc.cs in UblLarsen.Test project contain some helpful C# code for reading/writing 
xml files using XmlSerializer. This is all basic MCTS exam 70-536 stuff.


IT IS FREE!
------------
The library is free because the author does not have time nor resources to give any product support. 
I don't even sell support. It is not part of my business model. I do medium to long term .NET software 
development projects only..
Use the forums on http://ubllarsen.codeplex.com/ for general support, complaints about property rights, 
non-compliance to ubl, why some ubl types have been replaced and so on. Anyone can contribute.

Asker, Norway 25.6.2011
johan@itlarsen.net
